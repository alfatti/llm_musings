'At the top (under your Consts), add:
Private Const DEBUG_DUMP As Boolean = True   ' set False when done

'Add this helper to capture what’s happening at each stage:
Private Sub DebugDump(stage As String, payload As String, Optional chunkIdx As Long = 0)
    Const DBG As String = "DEBUG_GEMINI"
    Dim ws As Worksheet, lo As ListObject, lr As ListRow

    If Not SheetExists(DBG) Then
        Set ws = ThisWorkbook.Worksheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))
        ws.Name = DBG
        ws.Range("A1:D1").Value = Array("Timestamp", "Stage", "ChunkIdx", "Snippet")
        Set lo = ws.ListObjects.Add(xlSrcRange, ws.Range("A1:D1"), , xlYes)
        lo.TableStyle = "TableStyleLight9"
        ws.Columns("A:D").ColumnWidth = 36
        ws.Columns("D:D").WrapText = True
    Else
        Set ws = ThisWorkbook.Worksheets(DBG)
        If ws.ListObjects.Count = 0 Then
            ' convert header row to a table if user deleted it
            Set lo = ws.ListObjects.Add(xlSrcRange, ws.Range("A1").CurrentRegion, , xlYes)
        Else
            Set lo = ws.ListObjects(1)
        End If
    End If

    Set lr = lo.ListRows.Add
    lr.Range.Cells(1, 1).Value = Now
    lr.Range.Cells(1, 2).Value = stage
    lr.Range.Cells(1, 3).Value = chunkIdx
    lr.Range.Cells(1, 4).Value = Left$(payload, 32760)
End Sub



'2) Make sure TSV isn’t empty (and log it)
rrTSV = RangeToTSV(wsRR, headerRow)
DebugDump "TSV_BUILT", "len=" & Len(rrTSV) & vbCrLf & Left$(rrTSV, 1000), 0

If Len(rrTSV) = 0 Or InStr(rrTSV, vbCrLf) = 0 Then
    MsgBox "RAW_RENT_ROLL TSV looks empty or header-only. Check header detection.", vbExclamation
    Exit Sub
End If

